---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/organisms/Hero.astro';
import Card from '../components/Card.astro';
import { getCollection } from 'astro:content';

const latestProjects = await getCollection('projects', ({ data }) => {
  return new Date(data.publishDate) < new Date();
}).then(posts => posts.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()).slice(0, 1));

const latestTranslations = await getCollection('translations', ({ data }) => {
  return new Date(data.publishDate) < new Date();
}).then(posts => posts.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()).slice(0, 1));

const latestReflections = await getCollection('reflections', ({ data }) => {
  return new Date(data.publishDate) < new Date();
}).then(posts => posts.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()).slice(0, 1));

const latestPosts = [...latestProjects, ...latestTranslations, ...latestReflections].sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());
---

<BaseLayout title="My Portfolio" description="Product Designer">
  <Hero />
  <div class="mx-auto max-w-3xl">
    <div class="grid gap-8">
      {latestPosts.map(post => (
        <a href={`/${post.collection}/${post.slug}`}>
          <Card>
            <h3 class="text-xl font-bold">{post.data.title}</h3>
            <p class="text-gray-500">{post.data.description}</p>
          </Card>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
